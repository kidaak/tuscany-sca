



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>
		Tuscany - Java Runtime Architecture</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          <meta name="author" content="
		Jeremy Boynes" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
  </head>
  <body class="composite">
    <div id="banner">
                          <span id="bannerLeft">
    
            Apache Tuscany Project
    
            </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">Last Published: Fri Feb 24 17:19:33 GMT 2006</div>
      <div class="xright">      <a href="http://www.apache.org/">Apache</a>
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn"><div id="navcolumn">      <h5>Tuscany</h5>
    <ul>
              
    <li class="none">
          <a href="index.html">Overview</a>
        </li>
              
    <li class="none">
          <a href="news.html">News</a>
        </li>
              
    <li class="none">
          <a href="documentation.html">Documentation</a>
        </li>
              
    <li class="none">
          <a href="faq.html">FAQ</a>
        </li>
              
    <li class="none">
          <a href="wiki.html">Wiki</a>
        </li>
              
    <li class="none">
          <a href="download.html">Download</a>
        </li>
              
    <li class="none">
          <a href="requirements.html">Requirements</a>
        </li>
          </ul>
      <h5>SCA Runtime for Java</h5>
    <ul>
              
    <li class="none">
          <a href="releasesscajava.html">Releases</a>
        </li>
              
    <li class="none">
          <a href="installjava.html">Installation Instructions</a>
        </li>
              
    <li class="none">
          <a href="userguidejava.html">User's Guide</a>
        </li>
              
    <li class="none">
          <a href="documentationscajava.html">Documentation</a>
        </li>
          </ul>
      <h5>SDO 2.0 for Java</h5>
    <ul>
              
    <li class="none">
          <a href="releasessdojava.html">Releases</a>
        </li>
              
    <li class="none">
          <a href="installjava.html">Installation Instructions</a>
        </li>
              
    <li class="none">
          <a href="userguidejava.html">User's Guide</a>
        </li>
              
    <li class="none">
          <a href="documentationsdojava.html">Documentation</a>
        </li>
          </ul>
      <h5>Relational Data Access Service for Java</h5>
    <ul>
              
    <li class="none">
          <a href="releasesdasjava.html">Releases</a>
        </li>
              
    <li class="none">
          <a href="installjava.html">Installation Instructions</a>
        </li>
              
    <li class="none">
          <a href="userguidejava.html">User's Guide</a>
        </li>
              
    <li class="none">
          <a href="documentationdasjava.html">Documentation</a>
        </li>
          </ul>
      <h5>SCA Runtime for C++</h5>
    <ul>
              
    <li class="none">
          <a href="releasescpp.html">Releases</a>
        </li>
              
    <li class="none">
          <a href="installcpp.html">Installation Instructions</a>
        </li>
              
    <li class="none">
          <a href="userguidecpp.html">User's Guide</a>
        </li>
              
    <li class="none">
          <a href="documentationscacpp.html">Documentation</a>
        </li>
          </ul>
      <h5>SDO 2.0 for C++</h5>
    <ul>
              
    <li class="none">
          <a href="releasescpp.html">Releases</a>
        </li>
              
    <li class="none">
          <a href="installcpp.html">Installation Instructions</a>
        </li>
              
    <li class="none">
          <a href="userguidecpp.html">User's Guide</a>
        </li>
              
    <li class="none">
          <a href="documentationsdocpp.html">Documentation</a>
        </li>
          </ul>
      <h5>Community</h5>
    <ul>
              
    <li class="none">
          <a href="getinvolved.html">Get Involved</a>
        </li>
              
    <li class="none">
          <a href="team-list.html">Committers</a>
        </li>
              
    <li class="none">
          <a href="svn.html">SVN Code Repository</a>
        </li>
              
    <li class="none">
          <a href="mail-lists.html">Mailing Lists</a>
        </li>
              
    <li class="none">
          <a href="bugs.html">Bugs</a>
        </li>
              
    <li class="none">
          <a href="howtobuildsite.html">HowToBuildSite</a>
        </li>
              
    <li class="none">
          <a href="reference.html">Reference Library</a>
        </li>
          </ul>
      <h5>Related Projects</h5>
    <ul>
              
    <li class="none">
          <a href="http://ws.apache.org/axis/">Axis</a>
        </li>
              
    <li class="none">
          <a href="http://geronimo.apache.org/">Geronimo</a>
        </li>
          </ul>
  <a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy">
              <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
            </a>
    </div></div>
    <div id="bodyColumn">
      <div id="contentBox">
        
	
	

	<div class="section"><h2>Tuscany Java Runtime Architecture</h2>

        <h1>Introduction</h1>
        <p>This document provides a high-level overview of the Tuscany Java Runtime architecture.</p>
        <h2>Project Structure</h2>
        <p>The runtime is organized into separate projects to facilitate a clean separation between
            functional units as well as reuse across a variety of host environments. The main
            functional units are: </p>
        <ul>
            <li>o.a.t.runtime.common</li>
            Basic utility code used throughout the runtime such as the logging monitor framework,
                io, discovery, and resource loading
            <li>o.a.t.runtime.model</li>
            Contains interfaces defining a representation of SCA SCDL used by the runtime - the
                logical model - to create runtime artifacts and an SDO implementation that generates
                it from XML. This project also contains XSD type definitions used to describe
                various runtime artifacts such as services.
            <li>o.a.t.runtime.core</li>
            The core runtime code. Contains configuration builders used to generate runtime
                artifacts - the runtime model - from the logical model, messaging and invocation
                infrastructure, the runtime artifacts (o.a.t.runtime.core.context), injection
                container, and proxy framework.
            <li>o.a.t.runtime.container.java</li>
            Code that implements functionality specific to the Java SCA Client and Implementation
                model, logical model extensions, builders, handlers and general POJO management.
        </ul>
        <p> The following is a pictorial representation of the project dependencies: <br></br>
            <img src="architecture/Slide1.png" alt="architecture dependencies"></img>
        </p>
        <h1>Basic Concepts</h1>
        <h2>Runtime</h2>
        <p>A running instance of an SCA container</p>
        <h2>Host Platform</h2>
        <p>An environment which the SCA runtime is deployed to, such as (but not limited to) Tomcat
            or a J2EE application server.</p>
        <h2>Runtime Artifacts</h2>
        <p>The core runtime includes the following key functional units: </p>
        <ul>
            <li>The Logical Configuration Model</li>
            <li>The Runtime Configuration Model</li>
            <li>Instance Contexts</li>
            <li>Messaging and Invocation Handling</li>
        </ul>
        <h3>The Logical Configuration Model</h3>
        
            <i>o.a.t.model, o.a.t.runtime.container.java.assembly</i>
        
        <p>The LCM is an in-memory representation of a set of one or more configuration sources and
            is designed for easy manipulation of configuration information. The LCM is derived from
            SCA SCDL and analogous to an Abstract Syntax Tree. Tuscany currently supports generating
            the LCM from XML using SDO but other data binding technologies may be substituted. The
            logical model may be represented as:<br></br>
            <img src="architecture/Slide2.png" alt="logical model"></img>
        </p>
        <h3>The Runtime Configuration Model</h3>
        <p>
            <i>o.a.t.model,o.a.t.runtime.core.builder, o.a.t.runtime.container.java.builder,
                o.a.t.runtime.container.java.injection</i>
        </p>
        <p>The RCM is a set of in-memory artifacts used by the runtime to â€œexecuteâ€� SCA code. The
            RCM is derived from the logical model but does not have to be â€œround-trippable.â€� Rather,
            it is designed and optimized for runtime processing work. The RCM is analogous to
            compiled output. </p>
        <h3>Instance Context</h3>
        <p>
            <i>o.a.t.runtime.core.context, o.a.t.runtime.container.java.context</i>
        </p>
        <p> The RCM produces instance contexts, which are responsible for managing runtime resources
            such as component implementation instances. The following is a simplified instance
            context inheritance hierarchy:</p>
        <img src="architecture/Slide3.png" alt="instance context"></img>
        <p>TuscanyModuleComponentContext implementations are responsible for providing module
            component functionality as specified by SCA, including assembly and management of SCA
            application component lifecycle. SimpleComponentContext implementations are responsible
            for managing component implementation instances for a particular type. For example,
            JavaComponentContext manages SCA POJO implementation types. Other SimpleComponentContext
            implementations may exist for other component types such as BPEL or XSLT. As detailed
            below, a TuscanyModuleComponentContextImpl (the implementation which supports SCA POJOs)
            indirectly contains SimpleComponentContexts.</p>
        <h3>Scope Containers</h3>
        <p>
            <i>o.a.t.runtime.core.context, o.a.t.runtime.core.context.scope</i>
        </p>
        <p>TuscanyModuleComponentContextImpl contains scope containers which are responsible for
            managing component instance visibility and lifecycle. That is, they implement scoping
            functionality defined by SCA. Generally, scope containers have collections of instance
            contexts associated with a scope key (an exception is the stateless scope). Instance
            contexts in turn contain one or more component implementation instances (the common case
            is a 1:1 relation). Concretely, an HTTP session scope container would have a collection
            of instance contexts associated with session keys. Therefore, for every session-scoped
            component, an instance context would exist (assuming the component was accessed). If the
            implementation type was SCA Java, the instance context would contain the actual POJO
            component implementation instance.<br></br>
            <img src="architecture/Slide4.png" alt="scope containers"></img><br></br> This relationship between the
            LCM, instance contexts, and scopes is depicted in the following diagram:<br></br>
            <img src="architecture/Slide5.png" alt="relations"></img>
        </p>
        <h3>Messaging and Invocation Handling </h3>
        <p>
            <i>o.a.t.runtime.core.invocation, o.a.t.runtime.core.message,
                o.a.t.runtime.core.pipeline, o.a.t.runtime.container.java.handler,
                o.a.t.runtime.container.java.injection</i>
        </p>
        <img src="architecture/Slide6.png" alt="invocation"></img>
        <p>Complete</p>
        <h1>The Recursive Runtime Design</h1>
        <h2>Assembly in the Large</h2>
        <h2>Assembly in the Small</h2>
        <h1>Dispatching</h1>
        <h2>Creating a new implementation instance</h2>
        <p>The following sequence diagram shows how new component implementation instances are
            created and configured (injected) with property and reference values using the default
            TuscanyModuleComponentContextImpl: <br></br><img src="architecture/Slide7.png" alt="implementation instance"></img>
        </p>
        <h2>Module event dispatching</h2>
        <p>Scope containers rely on a module context eventing mechanism to be notified of lifecycle
            changes in the runtime, for example, when a request processing starts/stops, a session
            starts/stops, or the module starts/stops. Scope containers have a reference to an
            EventContext, which returns an id associated with the current thread for a given scope
            type. This enables lazy id creation (e.g. lazy creation of HTTP session ids and
            contexts). The following sequence diagram traces how module eventing works for request
            and session lifecycles:<br></br><img src="architecture/Slide7.png" alt="dispatching"></img>
        </p>
        <h2>Entry point operation</h2>
        <h2>External service operation</h2>
        
        </div>
    

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2005-2006
    
          Apache Software Foundation
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
